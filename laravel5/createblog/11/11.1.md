# 专题模块

# 数据表设计

## 需求分析

专题模块需要有个专题表，我们假设这个专题表的专题有标题字段，点击某个标题，进入专题详情页。专题详情页中有一个按钮，这个按钮点击后出现浮层，浮层中显示我的未投稿这个专题的文章。

## 表设计

所以需要建立一个专题表，然后需要建立一个文章专题关系表。

// 演示：建立表

## 模型

同样，我们建立一个专题模型。在专题模型中，我们先定义模型的关联。

这个模型也是多对多的模型，一个文章可以投稿多个专题，一个专题可以包含多个文章。

* 一个专题包含多个文章
* 文章投稿专题
* 我的未投稿这个专题的文章

前面两个都很好写模型，分别是belongsToMany和save

第三个就比较复杂

这里使用到laravel模型的scope功能。

# 模型的scope

## 定义

scope的意思是范围，我们可以定义一个scopeXxx()的方法，这个方法第一个参数是Builder，后面的参数可以自定义。

## 使用

定义好了之后，我们可以在查询的时候使用$user->xxx()来进行查询。

比如Post这个模型，我们需要过滤出某个用户的，我们使用
```
public function scopeAuthorBy($query, $user_id)
{
    return $query->where('user_id', $user_id);
}
```
这样就能使用Post::where(xxx)->authorBy($user_id)来获取这个用户的所有文章了。

## 文章模型

// TODO： POST模型的scope实现

# 页面

// 演示：专题页面

// 演示：专题列表

// 演示：js加载

# 页面逻辑

## 路由

### 专题详情路由

## 控制器

## js逻辑
